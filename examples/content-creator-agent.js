/**
 * Example: Custom Content Creator Agent
 * 
 * This demonstrates how to create a specialized agent that works
 * with the AI Workflow Orchestrator
 */

import express from 'express';

const app = express();
app.use(express.json());

// Agent configuration
const AGENT_CONFIG = {
  id: 'content-creator-001',
  name: 'ContentCreatorPro',
  capabilities: ['writing', 'content_creation', 'seo', 'editing'],
  version: '1.0.0',
  pricing: {
    per_task: 2.5,
    currency: 'ADA',
  },
};

// Agent endpoint - receives tasks from orchestrator
app.post('/execute', async (req, res) => {
  console.log('Received task:', req.body);

  const { task_id, task_description, requirements, context } = req.body;

  try {
    // Simulate agent work
    console.log(`Processing task: ${task_id}`);
    
    // In a real agent, this would:
    // 1. Parse task requirements
    // 2. Execute specialized AI/ML models
    // 3. Generate high-quality output
    // 4. Validate results
    
    await simulateWork(3000);

    // Return results
    const result = {
      task_id,
      agent_id: AGENT_CONFIG.id,
      status: 'completed',
      output: {
        summary: `Completed content creation task: ${task_description}`,
        content: generateMockContent(task_description),
        metadata: {
          word_count: 1500,
          reading_time: '6 minutes',
          seo_score: 92,
          readability_score: 88,
          keywords: ['blockchain', 'technology', 'innovation'],
        },
        quality_indicators: {
          completeness: 0.95,
          accuracy: 0.92,
        },
      },
      execution_time_ms: 3000,
      timestamp: new Date().toISOString(),
    };

    console.log(`Task ${task_id} completed successfully`);
    res.json(result);

  } catch (error) {
    console.error('Task execution failed:', error);
    res.status(500).json({
      task_id,
      agent_id: AGENT_CONFIG.id,
      status: 'failed',
      error: error.message,
      timestamp: new Date().toISOString(),
    });
  }
});

// Health check endpoint
app.get('/health', (req, res) => {
  res.json({
    status: 'healthy',
    agent: AGENT_CONFIG,
    uptime: process.uptime(),
    timestamp: new Date().toISOString(),
  });
});

// Capabilities endpoint
app.get('/capabilities', (req, res) => {
  res.json({
    agent_id: AGENT_CONFIG.id,
    name: AGENT_CONFIG.name,
    capabilities: AGENT_CONFIG.capabilities,
    pricing: AGENT_CONFIG.pricing,
    status: 'available',
  });
});

// Helper functions
function simulateWork(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

function generateMockContent(description) {
  return `
# ${description}

## Introduction

This is a professionally crafted piece of content addressing: ${description}.

## Main Content

Lorem ipsum dolor sit amet, consectetur adipiscing elit. In the world of blockchain 
and decentralized systems, innovation drives progress. Our analysis reveals key 
insights that can transform your understanding.

## Key Points

1. **Innovation**: Cutting-edge approaches to complex problems
2. **Scalability**: Solutions that grow with your needs
3. **Security**: Built with best practices in mind
4. **Efficiency**: Optimized for performance

## Conclusion

This comprehensive analysis provides actionable insights and recommendations for 
moving forward with confidence.

---
*Generated by ContentCreatorPro - Quality content at scale*
  `.trim();
}

// Start the agent server
const PORT = process.env.PORT || 3001;
app.listen(PORT, () => {
  console.log(`
╔════════════════════════════════════════╗
║   Content Creator Agent Started        ║
╚════════════════════════════════════════╝

Agent: ${AGENT_CONFIG.name}
ID: ${AGENT_CONFIG.id}
Port: ${PORT}
Capabilities: ${AGENT_CONFIG.capabilities.join(', ')}
Status: Ready to receive tasks

Endpoints:
- POST http://localhost:${PORT}/execute
- GET  http://localhost:${PORT}/health
- GET  http://localhost:${PORT}/capabilities
  `);
});

// Graceful shutdown
process.on('SIGTERM', () => {
  console.log('Shutting down gracefully...');
  process.exit(0);
});
